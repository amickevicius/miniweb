{"ast":null,"code":"import { BehaviorSubject, of } from 'rxjs';\nimport { catchError, defaultIfEmpty, mapTo, publishReplay, refCount, startWith, switchMap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/users.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"./users-list-view/users-list-view.component\";\n\nfunction UsersListComponent_p_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.errorMessage);\n  }\n}\n\nfunction UsersListComponent_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\n\nfunction UsersListComponent_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-users-list-view\", 4);\n    i0.ɵɵlistener(\"deleteUser\", function UsersListComponent_ng_template_3_Template_app_users_list_view_deleteUser_0_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.onDeleteUser($event);\n    });\n    i0.ɵɵpipe(1, \"async\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"users\", i0.ɵɵpipeBind1(1, 1, ctx_r3.users$));\n  }\n}\n\nfunction UsersListComponent_ng_template_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 5);\n  }\n}\n\nexport class UsersListComponent {\n  constructor(usersService) {\n    this.usersService = usersService;\n    this.refreshUsersListSubject$ = new BehaviorSubject(true);\n    this.users$ = this.refreshUsersListSubject$.pipe(switchMap(() => this.usersService.getUsers().pipe(catchError(error => {\n      if (error.status === 404) {\n        this.errorMessage = 'Not found';\n      }\n\n      if (error.status === 500) {\n        this.errorMessage = 'Happened internal server error :)';\n      }\n\n      return of(null);\n    }))), publishReplay(1), refCount());\n    this.loading$ = this.users$.pipe(mapTo(false), // map emit to false\n    defaultIfEmpty(false), // if nothing emitted - emit false\n    startWith(true), // start as loading right away\n    catchError(() => of(false)) // on error - emit false\n    );\n  }\n\n  onDeleteUser(userId) {\n    this.usersService.deleteUser(userId).pipe().subscribe(() => {\n      this.refreshUsersListSubject$.next(true);\n    });\n  }\n\n}\n\nUsersListComponent.ɵfac = function UsersListComponent_Factory(t) {\n  return new (t || UsersListComponent)(i0.ɵɵdirectiveInject(i1.UsersService));\n};\n\nUsersListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: UsersListComponent,\n  selectors: [[\"app-users-list\"]],\n  decls: 7,\n  vars: 6,\n  consts: [[4, \"ngIf\"], [4, \"ngIf\", \"ngIfThen\", \"ngIfElse\"], [\"contentTemplate\", \"\"], [\"spinnerTemplate\", \"\"], [3, \"users\", \"deleteUser\"], [1, \"spinner\"]],\n  template: function UsersListComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, UsersListComponent_p_0_Template, 2, 1, \"p\", 0);\n      i0.ɵɵtemplate(1, UsersListComponent_ng_container_1_Template, 1, 0, \"ng-container\", 1);\n      i0.ɵɵpipe(2, \"async\");\n      i0.ɵɵtemplate(3, UsersListComponent_ng_template_3_Template, 2, 3, \"ng-template\", null, 2, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵtemplate(5, UsersListComponent_ng_template_5_Template, 1, 0, \"ng-template\", null, 3, i0.ɵɵtemplateRefExtractor);\n    }\n\n    if (rf & 2) {\n      const _r2 = i0.ɵɵreference(4);\n\n      const _r4 = i0.ɵɵreference(6);\n\n      i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 4, ctx.loading$))(\"ngIfThen\", _r4)(\"ngIfElse\", _r2);\n    }\n  },\n  directives: [i2.NgIf, i3.UsersListViewComponent],\n  pipes: [i2.AsyncPipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ1c2Vycy1saXN0LmNvbXBvbmVudC5zY3NzIn0= */\"]\n});","map":{"version":3,"sources":["C:/Users/User/Desktop/my-app/src/app/users/users-list/users-list.component.ts"],"names":["BehaviorSubject","of","catchError","defaultIfEmpty","mapTo","publishReplay","refCount","startWith","switchMap","i0","i1","i2","i3","UsersListComponent_p_0_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ctx_r0","ɵɵnextContext","ɵɵadvance","ɵɵtextInterpolate","errorMessage","UsersListComponent_ng_container_1_Template","ɵɵelementContainer","UsersListComponent_ng_template_3_Template","_r7","ɵɵgetCurrentView","ɵɵlistener","UsersListComponent_ng_template_3_Template_app_users_list_view_deleteUser_0_listener","$event","ɵɵrestoreView","ctx_r6","onDeleteUser","ɵɵpipe","ctx_r3","ɵɵproperty","ɵɵpipeBind1","users$","UsersListComponent_ng_template_5_Template","ɵɵelement","UsersListComponent","constructor","usersService","refreshUsersListSubject$","pipe","getUsers","error","status","loading$","userId","deleteUser","subscribe","next","ɵfac","UsersListComponent_Factory","t","ɵɵdirectiveInject","UsersService","ɵcmp","ɵɵdefineComponent","type","selectors","decls","vars","consts","template","UsersListComponent_Template","ɵɵtemplate","ɵɵtemplateRefExtractor","_r2","ɵɵreference","_r4","directives","NgIf","UsersListViewComponent","pipes","AsyncPipe","styles"],"mappings":"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","sourcesContent":["import { BehaviorSubject, of } from 'rxjs';\r\nimport { catchError, defaultIfEmpty, mapTo, publishReplay, refCount, startWith, switchMap } from 'rxjs/operators';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"../services/users.service\";\r\nimport * as i2 from \"@angular/common\";\r\nimport * as i3 from \"./users-list-view/users-list-view.component\";\r\nfunction UsersListComponent_p_0_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"p\");\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r0 = i0.ɵɵnextContext();\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate(ctx_r0.errorMessage);\r\n} }\r\nfunction UsersListComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementContainer(0);\r\n} }\r\nfunction UsersListComponent_ng_template_3_Template(rf, ctx) { if (rf & 1) {\r\n    const _r7 = i0.ɵɵgetCurrentView();\r\n    i0.ɵɵelementStart(0, \"app-users-list-view\", 4);\r\n    i0.ɵɵlistener(\"deleteUser\", function UsersListComponent_ng_template_3_Template_app_users_list_view_deleteUser_0_listener($event) { i0.ɵɵrestoreView(_r7); const ctx_r6 = i0.ɵɵnextContext(); return ctx_r6.onDeleteUser($event); });\r\n    i0.ɵɵpipe(1, \"async\");\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const ctx_r3 = i0.ɵɵnextContext();\r\n    i0.ɵɵproperty(\"users\", i0.ɵɵpipeBind1(1, 1, ctx_r3.users$));\r\n} }\r\nfunction UsersListComponent_ng_template_5_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelement(0, \"div\", 5);\r\n} }\r\nexport class UsersListComponent {\r\n    constructor(usersService) {\r\n        this.usersService = usersService;\r\n        this.refreshUsersListSubject$ = new BehaviorSubject(true);\r\n        this.users$ = this.refreshUsersListSubject$.pipe(switchMap(() => this.usersService.getUsers().pipe(catchError((error) => {\r\n            if (error.status === 404) {\r\n                this.errorMessage = 'Not found';\r\n            }\r\n            if (error.status === 500) {\r\n                this.errorMessage = 'Happened internal server error :)';\r\n            }\r\n            return of(null);\r\n        }))), publishReplay(1), refCount());\r\n        this.loading$ = this.users$.pipe(mapTo(false), // map emit to false\r\n        defaultIfEmpty(false), // if nothing emitted - emit false\r\n        startWith(true), // start as loading right away\r\n        catchError(() => of(false)) // on error - emit false\r\n        );\r\n    }\r\n    onDeleteUser(userId) {\r\n        this.usersService.deleteUser(userId).pipe().subscribe(() => {\r\n            this.refreshUsersListSubject$.next(true);\r\n        });\r\n    }\r\n}\r\nUsersListComponent.ɵfac = function UsersListComponent_Factory(t) { return new (t || UsersListComponent)(i0.ɵɵdirectiveInject(i1.UsersService)); };\r\nUsersListComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: UsersListComponent, selectors: [[\"app-users-list\"]], decls: 7, vars: 6, consts: [[4, \"ngIf\"], [4, \"ngIf\", \"ngIfThen\", \"ngIfElse\"], [\"contentTemplate\", \"\"], [\"spinnerTemplate\", \"\"], [3, \"users\", \"deleteUser\"], [1, \"spinner\"]], template: function UsersListComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵtemplate(0, UsersListComponent_p_0_Template, 2, 1, \"p\", 0);\r\n        i0.ɵɵtemplate(1, UsersListComponent_ng_container_1_Template, 1, 0, \"ng-container\", 1);\r\n        i0.ɵɵpipe(2, \"async\");\r\n        i0.ɵɵtemplate(3, UsersListComponent_ng_template_3_Template, 2, 3, \"ng-template\", null, 2, i0.ɵɵtemplateRefExtractor);\r\n        i0.ɵɵtemplate(5, UsersListComponent_ng_template_5_Template, 1, 0, \"ng-template\", null, 3, i0.ɵɵtemplateRefExtractor);\r\n    } if (rf & 2) {\r\n        const _r2 = i0.ɵɵreference(4);\r\n        const _r4 = i0.ɵɵreference(6);\r\n        i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 4, ctx.loading$))(\"ngIfThen\", _r4)(\"ngIfElse\", _r2);\r\n    } }, directives: [i2.NgIf, i3.UsersListViewComponent], pipes: [i2.AsyncPipe], styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ1c2Vycy1saXN0LmNvbXBvbmVudC5zY3NzIn0= */\"] });\r\n"]},"metadata":{},"sourceType":"module"}